generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id          Int          @id @default(autoincrement())
  nome        String
  senha_hash  String
  email       String       @unique
  telefone    String       @unique
  tipo_conta  TipoConta?
  criado_em   DateTime     @default(now())
  contratante Contratante?
  prestador   Prestador?
}

model Localizacao {
  id           Int           @id @default(autoincrement())
  logradouro   String
  numero       String?
  bairro       String
  cidade       String
  cep          String?
  latitude     Decimal
  longitude    Decimal
  contratantes Contratante[]
  prestadores  Prestador[]   @relation("LocalizacaoToPrestador")
}

model Contratante {
  id             Int          @id @default(autoincrement())
  necessidade    Necessidade?
  id_usuario     Int          @unique
  id_localizacao Int
  localizacao    Localizacao  @relation(fields: [id_localizacao], references: [id])
  usuario        Usuario      @relation(fields: [id_usuario], references: [id])

  @@index([id_localizacao], map: "Contratante_id_localizacao_fkey")
}

model Prestador {
  id         Int           @id @default(autoincrement())
  id_usuario Int           @unique
  documentos Documento[]
  usuario    Usuario       @relation(fields: [id_usuario], references: [id])
  locais     Localizacao[] @relation("LocalizacaoToPrestador")
}

model Documento {
  id             Int           @id @default(autoincrement())
  tipo_documento TipoDocumento
  valor          String
  data_validade  DateTime?
  arquivo_url    String?
  id_prestador   Int
  prestador      Prestador     @relation(fields: [id_prestador], references: [id])

  @@index([id_prestador], map: "Documento_id_prestador_fkey")
}

enum TipoConta {
  CONTRATANTE
  PRESTADOR
}

enum Necessidade {
  IDOSO
  DEF_VISUAL
  DEF_AUDITIVA
  DEF_MOTORA
  DEF_INTELECTUAL
}

enum TipoDocumento {
  RG
  CPF
  CNH_EAR
  TIPO_VEICULO
  MODELO_VEICULO
  ANO_VEICULO
}
